<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>

    <!-- Google Maps API (replace YOUR_GOOGLE_MAPS_API_KEY with your API key) -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1YopGX9pi7LHZbClS1DoNaUDh9JNgIjw" async defer></script>

    <script>
        function initMap() {
            const lat = parseFloat(document.getElementById('latitude').value);
            const lon = parseFloat(document.getElementById('longitude').value);

            const map = new google.maps.Map(document.getElementById('map'), {
                zoom: 8,
                center: { lat: lat, lng: lon }
            });

            const marker = new google.maps.Marker({
                position: { lat: lat, lng: lon },
                map: map
            });
        }
    </script>
</head>
<body>
    <h1>Weather App</h1>

    <!-- Search form -->
    <form action="/searchWeather" method="get">
        <label for="city">City:</label>
        <input type="text" id="city" name="city" required>

        <label for="countryCode">Country:</label>
        <select id="countryCode" name="countryCode">
            <option value="IRE">Ireland</option>
            <option value="US">United States</option>
            <option value="CA">Canada</option>
            <option value="GB">United Kingdom</option>
            <option value="FR">France</option>
            <option value="DE">Germany</option>

        </select>

        <button type="submit">Get Weather</button>
    </form>

    <!-- Display the weather data -->
    <div id="weatherResult" th:if="${weather != null}">
        <p>
            City: <span th:text="${weather.city}"></span> <br>
            Country: <span th:text="${weather.country}"></span> <br>
            Weather: <span th:text="${weather.description}"></span> <br>
            Temperature: <span th:text="${weather.temperature}"></span> Â°C <br>
            Latitude: <span th:text="${weather.latitude}"></span> <br>
            Longitude: <span th:text="${weather.longitude}"></span>
        </p>

        <!-- Hidden fields to pass latitude and longitude to JavaScript -->
        <input type="hidden" id="latitude" th:value="${weather.latitude}">
        <input type="hidden" id="longitude" th:value="${weather.longitude}">
    </div>

    <!-- Google Map -->
    <div id="map" style="height: 400px; width: 100%;" th:if="${weather != null}"></div>

    <!-- Initialize the map only if weather data is available -->
    <script th:if="${weather != null}">
        initMap();
    </script>
</body>
</html>